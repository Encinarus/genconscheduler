<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"/>
  <link type="text/css" rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/1.6.4/fullcalendar.css"/>
  <link type="text/css" rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/1.6.4/fullcalendar.print.css"/>
  <link type="text/css" rel="stylesheet" href="/static/stylesheets/main.css"/>

  <title>Starred Events</title>

  <style>
    a.calevent div.fc-event-inner{
      color: #FFFFFF;
    }

    a.calANI div.fc-event-inner{background-color: #A9177E;}
    a.calBGM div.fc-event-inner{background-color: #0073AA;}
    a.calCGM div.fc-event-inner{background-color: #6B2355;}
    a.calEGM div.fc-event-inner{background-color: #858E95;}
    a.calENT div.fc-event-inner{background-color: #C94088;}
    a.calFLM div.fc-event-inner{background-color: #4B4761;}
    a.calHMN div.fc-event-inner{background-color: #2A3181;}
    a.calKID div.fc-event-inner{background-color: #9470AA;}
    a.calLRP div.fc-event-inner{background-color: #AE8B1C;}
    a.calMHE div.fc-event-inner{background-color: #E8B51C;}
    a.calNMN div.fc-event-inner{background-color: #686F1F;}
    a.calRPG div.fc-event-inner{background-color: #448A80;}
    a.calRPGA div.fc-event-inner{background-color: #D67917;}
    a.calSEM div.fc-event-inner{background-color: #009CDF;}
    a.calSPA div.fc-event-inner{background-color: #A6C749;}
    a.calTCG div.fc-event-inner{background-color: #1C944A;}
    a.calTDA div.fc-event-inner{background-color: #771F17;}
    a.calTRD div.fc-event-inner{background-color: #878F68;}
    a.calWKS div.fc-event-inner{background-color: #5E3C03;}
    a.calZED div.fc-event-inner{background-color: #75B9B8;}
  </style>
  

</head>

<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation" th:replace="core :: topnav">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Gen Con 2013 Scheduler</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">Home</a></li>
        <li><a href="#about">About</a></li>
      </ul>
      <form class="navbar-form navbar-right col-sm-6" action="/search">
        <input type="text" class="form-control" style="min-width: 300px;" placeholder="Search..." />
      </form>
    </div><!--/.nav-collapse -->
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="main">
      <h1 class="page-header">Starred Events</h1>

      <ul class="nav nav-tabs nav-justified" id="starredgroup">
        <li class="active"><a href="#day-tab" data-toggle="tab">By day</a></li>
        <li><a href="#type-tab" data-toggle="tab">By type</a></li>
        <li><a href="#calendar-tab" data-toggle="tab">Calendar</a></li>
      </ul>

      <!-- Tab panes -->
      <div class="tab-content">
        <div class="tab-pane active" id="day-tab">
          <div th:each="day : ${eventsByDay.keySet()}">
            <h3 th:text="${day}">Wednesday</h3>

            <div style="padding-left: 3em;" th:each="r : ${eventsByDay.get(day)}">
              <ul class="list-unstyled">
                <li>
                  <strong>
                    <span th:text="${r.readableStartTime}">8:00am</span> - <span th:text="${r.readableEndTime}">10:00pm</span>
                  </strong>: <a href="/event/1234" th:href="@{${urls.sitePath('event') + r.gameId}}"><span th:text="${r.gameId}">TDA1234567</span></a>
                  <span th:text="${r.title}">Lycans Afoot!</span> (<a href="#" th:href="@{${r.genconUrl}}">Official Listing</a>)</li>
                <li style="padding-left: 2em"><a href="#" th:href="@{${urls.sitePath('category') + r.eventTypeAbbreviation}}" th:text="${r.eventType}">TDA - True Dungeon Adventures</a>
                  <span th:unless="${r.gameSystem == null &amp;&amp; r.rulesEdition == null}" th:text="'/ ' + ${r.gameSystem} + ' ' + ${r.rulesEdition}"></span></li>
                <li style="padding-left: 2em" th:text="${r.shortDescription}">Face off against werewolves in True Dungeon!</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="tab-pane" id="type-tab">
          <div th:each="category : ${eventsByCategory.keySet()}">
            <h3 th:text="${category}">Category</h3>

            <div style="padding-left: 3em;" th:each="r : ${eventsByCategory.get(category)}">
              <ul class="list-unstyled">
                <li><strong>
                  <span th:text="${r.readableDay}">Thursday</span> <span th:text="${r.readableStartTime}">8:00am</span> - <span th:text="${r.readableEndTime}">10:00pm</span>
                </strong>: <a href="/event/1234" th:href="@{${urls.sitePath('event') + r.gameId}}"><span th:text="${r.gameId}">TDA1234567</span></a>
                  <span th:text="${r.title}">Lycans Afoot!</span> (<a href="#" th:href="@{${r.genconUrl}}">Official Listing</a>)</li>
                <li><span th:unless="${r.gameSystem == null &amp;&amp; r.rulesEdition == null}" th:text="${r.gameSystem} + ' ' + ${r.rulesEdition}"></span></li>
                <li style="padding-left: 2em" th:text="${r.shortDescription}">Face off against werewolves in True Dungeon!</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="tab-pane" id="calendar-tab">
          <!-- This doesn't look as good as it should... -->
          <ul class="nav nav-pills nav-justified" id="daygroup">
            <li><a href="#wednesday">Wednesday</a></li>
            <li class="active"><a href="#thursday">Thursday</a></li>
            <li><a href="#friday">Friday</a></li>
            <li><a href="#saturday">Saturday</a></li>
            <li><a href="#sunday">Sunday</a></li>
          </ul>
          <div id='calendar' class="tab-content" style="padding-top: 10px;"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div th:replace="core :: pagefooter">I did this!</div>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/1.6.4/fullcalendar.min.js"></script>

<script th:inline="javascript">
/*<![CDATA[*/
  $('#starredgroup a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  });

  $('#starredgroup a[href="#calendar-tab"]').click(function(e) {
    // The calendar won't render when hidden, so when we select the tab, we need to show it again
    $('#calendar').fullCalendar('render');
  });

  $('#daygroup a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  });

  // These are all horribly redundant... but my js-foo isn't there yet.
  $('#daygroup a[href="#wednesday"]').click(function(e) {
    e.preventDefault();

    $('#calendar').fullCalendar( 'gotoDate', 2014, 7, 13 );
  });

  $('#daygroup a[href="#thursday"]').click(function(e) {
    e.preventDefault();
    $('#calendar').fullCalendar( 'gotoDate', 2014, 7, 14 );
  });

  $('#daygroup a[href="#friday"]').click(function(e) {
    e.preventDefault();
    $('#calendar').fullCalendar( 'gotoDate', 2014, 7, 15 );
  });

  $('#daygroup a[href="#saturday"]').click(function(e) {
    e.preventDefault();
    $('#calendar').fullCalendar( 'gotoDate', 2014, 7, 16 );
  });

  $('#daygroup a[href="#sunday"]').click(function(e) {
    e.preventDefault();
    $('#calendar').fullCalendar( 'gotoDate', 2014, 7, 17 );
  });

  $(document).ready(function() {
    // And populate the calendar
    var groupedEvents = /*[[${calendarEvents}]]*/;
    var events = [];

    for (var i = 0; i < groupedEvents.length; i++) {
      group = groupedEvents[i];
      events.push({
        title: group.title,
        start: group.startTimeSeconds,
        end: group.endTimeSeconds,
        url: group.genconUrl,
        className: ['cal' + group.shortCat, 'calevent']
      });
    }

    $('#calendar').fullCalendar({
      header: {
				left: '',
				center: 'title',
				right: 'agendaWeek,agendaDay'
			},
			firstDay: 3,
      defaultView: 'agendaDay',
      editable: false,
      hiddenDays: [1, 2],
      eventClick: function(event) {
        if (event.url) {
          // open in new tab
          window.open(event.url);
          return false;
        }
      },
      allDayDefault: false,
      events: events,
    });

    $('#calendar').fullCalendar( 'changeView', 'agendaDay' );
    $('#calendar').fullCalendar( 'gotoDate', 2014, 7, 14 );
  });


/*]]>*/
</script>

</body>
</html>
